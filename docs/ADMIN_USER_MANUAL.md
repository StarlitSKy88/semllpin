# SmellPin 管理人员使用手册

## 目录
- [1. 系统概述](#1-系统概述)
- [2. 登录与权限](#2-登录与权限)
- [3. 仪表盘](#3-仪表盘)
- [4. 用户管理](#4-用户管理)
- [5. 内容审核](#5-内容审核)
- [6. 系统配置](#6-系统配置)
- [7. 日志管理](#7-日志管理)
- [8. 数据统计](#8-数据统计)
- [9. 故障处理](#9-故障处理)
- [10. 常见问题](#10-常见问题)
- [11. 最佳实践](#11-最佳实践)

## 1. 系统概述

### 1.1 SmellPin 简介

SmellPin 是一个基于地理位置的恶搞标注社交平台，用户可以在地图上添加有趣的标注，分享生活中的趣事。管理后台提供了完整的用户管理、内容审核、系统配置等功能。

### 1.2 管理后台功能

- **用户管理**：用户信息查看、状态管理、权限分配
- **内容审核**：标注内容审核、举报处理、违规内容管理
- **系统配置**：站点设置、支付配置、邮件配置等
- **数据统计**：用户活跃度、内容统计、收入分析
- **日志管理**：操作日志、系统日志、错误日志

### 1.3 管理员角色

| 角色 | 权限描述 |
|------|----------|
| SUPER_ADMIN | 超级管理员，拥有所有权限 |
| CONTENT_REVIEWER | 内容审核员，负责内容审核和举报处理 |
| USER_MANAGER | 用户管理员，负责用户管理和客服 |
| SYSTEM_ADMIN | 系统管理员，负责系统配置和维护 |

## 2. 登录与权限

### 2.1 访问管理后台

1. **访问地址**
   ```
   生产环境：https://www.yourdomain.com/#/admin
   测试环境：http://localhost:5176/#/admin
   ```

2. **登录要求**
   - 必须拥有管理员权限的账号
   - 账号状态必须为 `ACTIVE`
   - 支持邮箱和用户名登录

3. **首次登录**
   - 使用超级管理员账号登录
   - 默认账号：admin@smellpin.com
   - 默认密码：请联系系统管理员获取

### 2.2 权限管理

**查看当前权限**
- 登录后在右上角用户菜单中查看当前角色
- 不同角色看到的菜单项会有所不同

**权限分配**
- 只有 SUPER_ADMIN 可以分配管理员权限
- 在用户管理页面选择用户，点击「修改角色」
- 可以同时分配多个角色

### 2.3 安全设置

**密码要求**
- 最少8位字符
- 包含大小写字母、数字和特殊字符
- 建议定期更换密码

**登录安全**
- 支持双因素认证（2FA）
- 异常登录会发送邮件通知
- 连续登录失败会临时锁定账号

## 3. 仪表盘

### 3.1 概览统计

仪表盘首页显示关键指标：

**用户统计**
- 总注册用户数
- 今日新增用户
- 活跃用户数（日/周/月）
- 用户增长趋势图

**内容统计**
- 总标注数量
- 今日新增标注
- 待审核内容数量
- 举报处理状态

**收入统计**
- 今日收入
- 本月收入
- 收入趋势图
- 支付成功率

**系统状态**
- 服务器状态
- 数据库连接状态
- Redis 连接状态
- 存储使用情况

### 3.2 快速操作

仪表盘提供常用操作的快捷入口：
- 待审核内容（显示数量徽章）
- 最新用户举报
- 系统异常告警
- 最近操作日志

### 3.3 实时数据

- 数据每5分钟自动刷新
- 支持手动刷新
- 异常数据会高亮显示
- 支持设置数据告警阈值

## 4. 用户管理

### 4.1 用户列表

**访问路径**：侧边栏 → 用户管理

**列表字段**
| 字段 | 说明 |
|------|------|
| 用户ID | 系统唯一标识 |
| 用户名 | 用户设置的显示名称 |
| 邮箱 | 注册邮箱地址 |
| 状态 | ACTIVE/SUSPENDED/BANNED |
| 角色 | 用户权限角色 |
| 注册时间 | 账号创建时间 |
| 最后登录 | 最近一次登录时间 |
| 操作 | 查看/编辑/封禁等 |

### 4.2 搜索与筛选

**搜索功能**
- 支持按用户名、邮箱、ID搜索
- 支持模糊搜索
- 搜索结果实时显示

**筛选条件**
- 用户状态：全部/活跃/暂停/封禁
- 用户角色：普通用户/管理员
- 注册时间：今天/本周/本月/自定义
- 最后登录：活跃/不活跃用户

**批量操作**
- 选择多个用户进行批量操作
- 支持批量封禁/解封
- 支持批量发送通知
- 支持批量导出数据

### 4.3 用户详情

点击用户名或「查看」按钮进入用户详情页：

**基本信息**
- 个人资料（头像、昵称、简介）
- 联系信息（邮箱、手机）
- 账号状态和权限
- 注册和登录记录

**活动统计**
- 发布的标注数量
- 评论和点赞数
- 被举报次数
- 收入和支出记录

**操作历史**
- 最近的登录记录
- 重要操作日志
- 管理员操作记录

### 4.4 用户操作

**状态管理**
```
ACTIVE（活跃）
├── 可以正常使用所有功能
├── 可以发布和查看内容
└── 可以进行支付操作

SUSPENDED（暂停）
├── 暂时限制部分功能
├── 可以查看但不能发布内容
└── 需要联系客服解除

BANNED（封禁）
├── 禁止登录和使用
├── 所有内容被隐藏
└── 需要管理员手动解封
```

**具体操作步骤**

1. **封禁用户**
   - 点击用户操作菜单中的「封禁」
   - 选择封禁原因（违规内容/恶意行为/其他）
   - 填写封禁说明（必填）
   - 选择封禁时长（永久/临时）
   - 确认操作

2. **解封用户**
   - 在封禁用户列表中找到目标用户
   - 点击「解封」按钮
   - 填写解封原因
   - 确认操作

3. **重置密码**
   - 点击「重置密码」
   - 系统自动生成临时密码
   - 发送重置邮件给用户
   - 用户首次登录时强制修改密码

4. **修改角色**
   - 点击「修改角色」
   - 选择要分配的角色（可多选）
   - 填写变更原因
   - 确认操作

### 4.5 用户通知

**发送通知**
- 选择通知类型（系统通知/警告/公告）
- 编写通知内容（支持富文本）
- 选择发送方式（站内信/邮件/短信）
- 设置发送时间（立即/定时）

**通知模板**
- 封禁通知模板
- 解封通知模板
- 违规警告模板
- 系统维护通知模板

## 5. 内容审核

### 5.1 审核列表

**访问路径**：侧边栏 → 内容审核

**审核内容类型**
- 用户标注（恶搞内容）
- 用户评论
- 用户举报
- 媒体文件（图片/视频）

**列表字段**
| 字段 | 说明 |
|------|------|
| 审核ID | 系统生成的审核记录ID |
| 内容类型 | 标注/评论/媒体文件 |
| 举报人 | 提交举报的用户 |
| 被举报人 | 内容发布者 |
| 举报原因 | 违规类型 |
| 举报时间 | 提交举报的时间 |
| 状态 | PENDING/APPROVED/REJECTED |
| 处理人 | 审核员 |
| 操作 | 查看详情/处理 |

### 5.2 举报原因分类

```
SPAM（垃圾信息）
├── 广告推广
├── 重复内容
└── 无意义内容

INAPPROPRIATE（不当内容）
├── 色情内容
├── 暴力内容
└── 恶意攻击

FAKE_LOCATION（虚假位置）
├── 位置信息错误
├── 恶意标注
└── 误导信息

HARASSMENT（骚扰行为）
├── 人身攻击
├── 恶意骚扰
└── 歧视言论

OTHER（其他）
├── 版权问题
├── 隐私侵犯
└── 其他违规
```

### 5.3 审核流程

**1. 查看举报详情**
- 点击审核记录的「查看详情」
- 查看被举报的具体内容
- 了解举报原因和说明
- 查看相关用户信息

**2. 内容预览**
- 标注内容：显示标注文字、图片、位置
- 评论内容：显示评论文字和上下文
- 媒体文件：支持图片预览和视频播放
- 位置信息：在地图上显示具体位置

**3. 审核决策**

**通过审核（APPROVED）**
- 内容符合社区规范
- 举报理由不充分
- 内容继续正常显示
- 记录审核日志

**驳回内容（REJECTED）**
- 内容确实违反规范
- 内容被隐藏或删除
- 发布者收到违规通知
- 严重违规可能导致用户封禁

**4. 填写审核意见**
- 详细说明审核理由
- 引用具体的违规条款
- 给出改进建议（如适用）
- 记录处理措施

### 5.4 批量审核

**批量操作**
- 选择多个待审核项目
- 统一设置审核结果
- 批量填写审核意见
- 一键提交处理结果

**快速审核**
- 对于明显的垃圾内容，支持快速驳回
- 对于误报内容，支持快速通过
- 预设常用的审核意见模板

### 5.5 审核统计

**个人统计**
- 今日审核数量
- 本周审核数量
- 审核通过率
- 平均处理时间

**团队统计**
- 团队总体审核效率
- 各审核员工作量分布
- 审核质量评估
- 待处理积压情况

## 6. 系统配置

### 6.1 站点设置

**访问路径**：侧边栏 → 系统配置 → 站点设置

**基本信息**
- 站点名称：SmellPin
- 站点描述：基于地理位置的恶搞标注平台
- 站点关键词：地图,标注,恶搞,社交
- 站点Logo：上传站点Logo图片
- 网站图标：上传Favicon

**联系信息**
- 客服邮箱：support@smellpin.com
- 客服电话：+86-xxx-xxxx-xxxx
- 公司地址：详细地址信息
- 工作时间：周一至周五 9:00-18:00

**地图设置**
- 默认中心点：北京市中心（116.4074, 39.9042）
- 默认缩放级别：12
- 最大缩放级别：18
- 最小缩放级别：3
- 地图样式：标准/卫星/地形

### 6.2 支付配置

**Stripe 配置**
```
公开密钥（Publishable Key）
├── 用于前端支付表单
├── 以 pk_live_ 或 pk_test_ 开头
└── 可以安全地暴露在客户端

私有密钥（Secret Key）
├── 用于服务器端API调用
├── 以 sk_live_ 或 sk_test_ 开头
└── 必须保密，不能暴露

Webhook 密钥（Webhook Secret）
├── 用于验证Webhook请求
├── 以 whsec_ 开头
└── 确保支付回调安全
```

**支付设置**
- 默认货币：USD
- 最小支付金额：$1.00
- 最大支付金额：$100.00
- 支付描述模板：SmellPin 恶搞标注支付
- 成功页面：/payment/success
- 取消页面：/payment/cancel

**测试支付**
- 配置完成后可以进行测试支付
- 使用测试卡号：4242 4242 4242 4242
- 过期日期：任意未来日期
- CVC：任意3位数字

### 6.3 邮件配置

**SMTP 设置**
```
Gmail 配置示例：
├── SMTP主机：smtp.gmail.com
├── SMTP端口：587
├── 加密方式：TLS
├── 用户名：your-email@gmail.com
└── 密码：应用专用密码

企业邮箱配置示例：
├── SMTP主机：smtp.exmail.qq.com
├── SMTP端口：465
├── 加密方式：SSL
├── 用户名：noreply@yourdomain.com
└── 密码：邮箱密码
```

**邮件模板**
- 注册验证邮件
- 密码重置邮件
- 支付成功通知
- 违规警告邮件
- 系统维护通知

**测试邮件**
- 配置完成后发送测试邮件
- 检查邮件是否正常发送和接收
- 验证邮件格式和内容

### 6.4 缓存配置

**Redis 设置**
- Redis主机：redis（Docker环境）
- Redis端口：6379
- Redis密码：设置强密码
- 数据库编号：0
- 连接超时：5秒

**缓存策略**
```
用户会话缓存
├── TTL：7天
├── 键前缀：session:
└── 自动清理过期会话

API响应缓存
├── TTL：5分钟
├── 键前缀：api:
└── 热点数据优先缓存

地图数据缓存
├── TTL：1小时
├── 键前缀：map:
└── 按区域分片缓存
```

**缓存管理**
- 查看缓存使用情况
- 手动清理特定缓存
- 设置缓存告警阈值
- 缓存命中率统计

### 6.5 安全配置

**访问控制**
- IP白名单：允许访问管理后台的IP
- IP黑名单：禁止访问的IP地址
- 地理位置限制：限制特定国家/地区访问
- 用户代理过滤：阻止恶意爬虫

**API限流**
- 每分钟请求限制：100次/IP
- 每小时请求限制：1000次/IP
- 登录失败限制：5次/10分钟
- 注册频率限制：3次/小时/IP

**内容安全**
- 敏感词过滤：自动检测和过滤敏感内容
- 图片内容检测：使用AI检测不当图片
- 垃圾内容识别：自动识别垃圾信息
- 恶意链接检测：检测和阻止恶意链接

## 7. 日志管理

### 7.1 操作日志

**访问路径**：侧边栏 → 日志管理 → 操作日志

**日志类型**
```
用户操作日志
├── 登录/登出记录
├── 密码修改记录
├── 个人信息修改
└── 重要操作记录

管理员操作日志
├── 用户管理操作
├── 内容审核操作
├── 系统配置修改
└── 权限变更记录

系统操作日志
├── 系统启动/关闭
├── 数据库操作
├── 缓存操作
└── 定时任务执行
```

**日志字段**
| 字段 | 说明 |
|------|------|
| 时间 | 操作发生的具体时间 |
| 操作人 | 执行操作的用户 |
| 操作类型 | CREATE/UPDATE/DELETE/LOGIN等 |
| 操作对象 | 被操作的资源 |
| 操作详情 | 具体的操作内容 |
| IP地址 | 操作来源IP |
| 用户代理 | 浏览器和设备信息 |
| 结果 | 成功/失败 |

### 7.2 系统日志

**错误日志**
- 应用程序错误
- 数据库连接错误
- 第三方服务错误
- 网络连接错误

**性能日志**
- 慢查询记录
- API响应时间
- 内存使用情况
- CPU使用情况

**安全日志**
- 异常登录尝试
- 可疑操作记录
- 攻击尝试记录
- 权限违规操作

### 7.3 日志查询

**搜索功能**
- 按时间范围搜索
- 按操作人搜索
- 按操作类型搜索
- 按关键词搜索

**高级筛选**
- 多条件组合筛选
- 正则表达式搜索
- 排除特定条件
- 自定义查询条件

**导出功能**
- 导出为CSV格式
- 导出为Excel格式
- 导出为PDF报告
- 定期自动导出

### 7.4 日志分析

**统计报表**
- 操作频率统计
- 用户活跃度分析
- 错误趋势分析
- 性能指标统计

**异常检测**
- 异常操作模式识别
- 可疑行为告警
- 性能异常提醒
- 安全威胁检测

## 8. 数据统计

### 8.1 用户统计

**用户增长**
- 注册用户趋势图
- 活跃用户趋势图
- 用户留存率分析
- 用户流失率分析

**用户行为**
- 登录频率分布
- 功能使用统计
- 内容发布统计
- 支付行为分析

**用户画像**
- 年龄分布
- 地域分布
- 设备类型分布
- 使用时长分布

### 8.2 内容统计

**内容数量**
- 标注总数趋势
- 评论总数趋势
- 媒体文件统计
- 内容分类统计

**内容质量**
- 举报率统计
- 审核通过率
- 用户评分分布
- 热门内容排行

**内容分布**
- 地理位置分布
- 时间分布
- 类型分布
- 热度分布

### 8.3 收入统计

**收入概览**
- 总收入统计
- 月度收入趋势
- 日均收入
- 收入增长率

**支付分析**
- 支付成功率
- 支付方式分布
- 平均支付金额
- 退款率统计

**用户价值**
- 付费用户比例
- 用户生命周期价值
- 复购率统计
- 高价值用户分析

### 8.4 系统统计

**性能指标**
- API响应时间
- 数据库查询性能
- 缓存命中率
- 错误率统计

**资源使用**
- 服务器CPU使用率
- 内存使用情况
- 磁盘使用情况
- 网络流量统计

**可用性统计**
- 系统正常运行时间
- 服务可用性
- 故障恢复时间
- SLA达成率

## 9. 故障处理

### 9.1 常见故障类型

**系统故障**
```
服务器故障
├── 服务器宕机
├── 网络连接问题
├── 硬件故障
└── 系统资源不足

应用故障
├── 应用程序崩溃
├── 内存泄漏
├── 死锁问题
└── 配置错误

数据库故障
├── 数据库连接失败
├── 查询超时
├── 数据损坏
└── 存储空间不足

第三方服务故障
├── 支付服务异常
├── 邮件服务故障
├── CDN服务问题
└── 地图服务异常
```

### 9.2 故障诊断

**快速诊断步骤**
1. 检查系统状态面板
2. 查看错误日志
3. 检查服务器资源使用情况
4. 测试关键功能
5. 检查第三方服务状态

**诊断工具**
- 系统监控面板
- 日志分析工具
- 性能监控工具
- 网络诊断工具

### 9.3 应急处理

**紧急联系人**
- 技术负责人：+86-xxx-xxxx-xxxx
- 运维工程师：+86-xxx-xxxx-xxxx
- 产品负责人：+86-xxx-xxxx-xxxx

**应急处理流程**
1. **故障确认**
   - 确认故障范围和影响
   - 评估故障严重程度
   - 通知相关人员

2. **临时措施**
   - 启用备用系统
   - 降级服务功能
   - 发布故障公告

3. **问题修复**
   - 定位问题根因
   - 实施修复方案
   - 验证修复效果

4. **恢复服务**
   - 逐步恢复功能
   - 监控系统状态
   - 更新故障公告

5. **事后总结**
   - 分析故障原因
   - 制定预防措施
   - 更新应急预案

### 9.4 预防措施

**监控告警**
- 设置关键指标告警
- 配置多级告警机制
- 建立告警响应流程

**备份策略**
- 定期数据备份
- 多地备份存储
- 备份恢复测试

**容灾准备**
- 备用服务器准备
- 灾难恢复预案
- 定期演练

## 10. 常见问题

### 10.1 用户管理问题

**Q: 如何批量导入用户？**
A: 目前系统不支持批量导入用户功能。如有大量用户需要导入，请联系技术团队协助处理。

**Q: 用户忘记密码怎么办？**
A: 
1. 在用户管理页面找到该用户
2. 点击「重置密码」按钮
3. 系统会发送重置邮件给用户
4. 用户点击邮件链接重置密码

**Q: 如何处理用户投诉？**
A:
1. 记录投诉详情
2. 调查相关情况
3. 与用户沟通解决方案
4. 必要时采取管理措施
5. 跟进处理结果

### 10.2 内容审核问题

**Q: 审核标准如何把握？**
A: 参考社区规范文档，主要原则：
- 不涉及色情、暴力、政治敏感内容
- 不包含恶意攻击或骚扰信息
- 位置信息准确，不误导用户
- 内容有趣但不恶意

**Q: 误审怎么处理？**
A:
1. 用户可以申请复审
2. 重新评估审核决定
3. 如确实误审，及时纠正
4. 向用户道歉并说明情况
5. 总结经验，避免类似错误

**Q: 如何处理争议内容？**
A:
1. 多人审核确认
2. 参考类似案例
3. 咨询法务意见
4. 必要时暂时下架
5. 制定明确处理标准

### 10.3 系统配置问题

**Q: 邮件发送失败怎么办？**
A:
1. 检查SMTP配置是否正确
2. 确认邮箱密码是否有效
3. 检查网络连接
4. 查看邮件服务商限制
5. 测试发送简单邮件

**Q: 支付回调失败怎么处理？**
A:
1. 检查Webhook URL是否正确
2. 确认Webhook密钥配置
3. 查看Stripe后台日志
4. 检查服务器防火墙设置
5. 手动处理失败的支付

**Q: 缓存不生效怎么办？**
A:
1. 检查Redis连接状态
2. 确认缓存配置正确
3. 查看缓存键是否正确
4. 检查TTL设置
5. 手动清理缓存重试

### 10.4 性能问题

**Q: 系统响应慢怎么优化？**
A:
1. 检查数据库查询性能
2. 优化慢查询SQL
3. 增加适当的索引
4. 启用缓存机制
5. 考虑增加服务器资源

**Q: 数据库连接数过多怎么处理？**
A:
1. 检查连接池配置
2. 优化数据库连接使用
3. 及时释放无用连接
4. 增加连接池大小
5. 监控连接使用情况

## 11. 最佳实践

### 11.1 日常管理

**每日检查清单**
- [ ] 查看系统状态面板
- [ ] 处理待审核内容
- [ ] 回复用户咨询
- [ ] 检查异常告警
- [ ] 查看关键指标

**每周任务**
- [ ] 分析用户增长数据
- [ ] 审查系统性能报告
- [ ] 更新内容审核标准
- [ ] 检查备份完整性
- [ ] 团队工作总结

**每月任务**
- [ ] 生成月度运营报告
- [ ] 评估系统容量需求
- [ ] 更新安全策略
- [ ] 进行灾难恢复演练
- [ ] 用户满意度调研

### 11.2 安全管理

**账号安全**
- 使用强密码
- 启用双因素认证
- 定期更换密码
- 不共享管理员账号
- 及时删除离职员工账号

**操作安全**
- 重要操作需要二次确认
- 批量操作要特别谨慎
- 定期备份重要数据
- 记录所有重要操作
- 遵循最小权限原则

**数据安全**
- 敏感数据加密存储
- 定期安全漏洞扫描
- 监控异常访问行为
- 及时更新系统补丁
- 建立数据泄露应急预案

### 11.3 用户服务

**响应时效**
- 用户咨询：2小时内回复
- 技术问题：4小时内处理
- 投诉举报：24小时内处理
- 紧急问题：1小时内响应

**服务态度**
- 耐心倾听用户问题
- 专业解答用户疑问
- 及时跟进处理进度
- 主动收集用户反馈
- 持续改进服务质量

**沟通技巧**
- 使用友好的语言
- 避免技术术语
- 提供具体的解决方案
- 设定合理的期望
- 保持专业形象

### 11.4 团队协作

**工作分工**
- 明确各人职责范围
- 建立轮班制度
- 设置备岗人员
- 定期技能培训
- 知识文档共享

**沟通协调**
- 建立工作群组
- 定期团队会议
- 及时信息同步
- 问题升级机制
- 经验分享交流

**质量控制**
- 建立操作规范
- 实施同行评议
- 定期质量检查
- 持续改进流程
- 建立激励机制

---

## 附录

### A. 快捷键列表

| 功能 | 快捷键 |
|------|--------|
| 全局搜索 | Ctrl + K |
| 刷新页面 | F5 |
| 返回上页 | Alt + ← |
| 前进下页 | Alt + → |
| 快速审核 | Space |
| 批量选择 | Ctrl + A |

### B. API 接口文档

详细的API接口文档请参考：
- 开发环境：http://localhost:3000/api-docs
- 生产环境：https://api.yourdomain.com/api-docs

### C. 错误代码对照表

| 错误代码 | 错误描述 | 解决方案 |
|----------|----------|----------|
| 1001 | 用户未登录 | 重新登录 |
| 1002 | 权限不足 | 联系管理员 |
| 2001 | 数据库连接失败 | 检查数据库状态 |
| 2002 | Redis连接失败 | 检查Redis状态 |
| 3001 | 支付服务异常 | 检查Stripe配置 |
| 3002 | 邮件发送失败 | 检查SMTP配置 |

### D. 联系信息

**技术支持**
- 邮箱：tech-support@yourcompany.com
- 电话：+86-xxx-xxxx-xxxx
- 工作时间：周一至周五 9:00-18:00

**紧急联系**
- 24小时热线：+86-xxx-xxxx-xxxx
- 紧急邮箱：emergency@yourcompany.com

**文档更新**
- 文档维护：docs@yourcompany.com
- 反馈建议：feedback@yourcompany.com

---

**文档版本：** v1.0  
**最后更新：** 2024年1月  
**适用版本：** SmellPin v1.0+  
**维护团队：** SmellPin 技术团队